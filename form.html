<!DOCTYPE html><html lang="en" data-theme="pastel"><head><base target="_top"/><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>CSE Placement Portal</title><link href="https://cdn.jsdelivr.net/npm/daisyui@5" rel="stylesheet"/><script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script><script src="https://unpkg.com/lucide@latest"></script><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet"/><style>:root{--color-base-100:oklch(98% 0.003 247.858);--color-base-200:oklch(96% 0.002 240);--color-base-300:oklch(90% 0.02 240);--color-base-content:oklch(25% 0.015 240);--color-primary:oklch(70% 0.18 250);--color-primary-content:oklch(98% 0.003 247.858);--color-secondary:oklch(75% 0.12 320);--color-secondary-content:oklch(25% 0.015 240);--color-accent:oklch(80% 0.15 180);--color-accent-content:oklch(25% 0.015 240);--color-neutral:oklch(60% 0.1 240);--color-neutral-content:oklch(98% 0.003 247.858);--color-info:oklch(75% 0.12 220);--color-info-content:oklch(25% 0.015 240);--color-success:oklch(75% 0.15 150);--color-success-content:oklch(98% 0.003 247.858);--color-warning:oklch(80% 0.18 60);--color-warning-content:oklch(25% 0.015 240);--color-error:oklch(65% 0.2 20);--color-error-content:oklch(98% 0.003 247.858)}[data-theme="dark"]{--color-base-100:oklch(15% 0.01 240);--color-base-200:oklch(12% 0.015 240);--color-base-300:oklch(20% 0.02 240);--color-base-content:oklch(90% 0.01 240);--color-primary:oklch(65% 0.2 250);--color-primary-content:oklch(15% 0.01 240);--color-secondary:oklch(70% 0.15 320);--color-secondary-content:oklch(15% 0.01 240);--color-accent:oklch(75% 0.18 180);--color-accent-content:oklch(15% 0.01 240);--color-neutral:oklch(25% 0.02 240);--color-neutral-content:oklch(90% 0.01 240);--color-info:oklch(70% 0.15 220);--color-info-content:oklch(15% 0.01 240);--color-success:oklch(70% 0.18 150);--color-success-content:oklch(15% 0.01 240);--color-warning:oklch(75% 0.2 60);--color-warning-content:oklch(15% 0.01 240);--color-error:oklch(60% 0.22 20);--color-error-content:oklch(90% 0.01 240)}body{font-family:'Inter',sans-serif;transition:background-color .3s ease,color .3s ease;background:linear-gradient(135deg,oklch(var(--color-base-100)) 0%,oklch(var(--color-base-200)) 100%);height:100vh;overflow:hidden}.fade-in{animation:fadeIn .4s ease-out}@keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.slide-in{animation:slideIn .3s ease-out}@keyframes slideIn{from{opacity:0;transform:translateX(-20px)}to{opacity:1;transform:translateX(0)}}.card-enhanced{backdrop-filter:blur(10px);background:oklch(var(--color-base-100)/.8);border:1px solid oklch(var(--color-base-300)/.3);box-shadow:0 4px 6px -1px oklch(var(--color-base-content)/.1),0 2px 4px -1px oklch(var(--color-base-content)/.06);transition:all .3s cubic-bezier(.4,0,.2,1)}.card-enhanced:hover{box-shadow:0 20px 25px -5px oklch(var(--color-base-content)/.1),0 10px 10px -5px oklch(var(--color-base-content)/.04);transform:translateY(-4px) scale(1.01)}.btn-enhanced{transition:all .2s cubic-bezier(.4,0,.2,1);font-weight:500;position:relative;overflow:hidden}.btn-enhanced:hover{transform:translateY(-2px);box-shadow:0 8px 15px oklch(var(--color-primary)/.2)}.btn-enhanced::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,oklch(var(--color-base-100)/.2),transparent);transition:left .5s}.btn-enhanced:hover::before{left:100%}.input-enhanced{transition:all .3s ease;border-width:2px;background:oklch(var(--color-base-100)/.6);backdrop-filter:blur(5px)}.input-enhanced:focus{border-color:oklch(var(--color-primary));box-shadow:0 0 0 4px oklch(var(--color-primary)/.1);background:oklch(var(--color-base-100))}.mobile-nav{display:flex;gap:.5rem;align-items:center}.mobile-nav-btn{padding:.5rem;border-radius:.5rem;background:transparent;color:oklch(var(--color-base-content));text-decoration:none;transition:all .2s ease;font-size:.875rem;font-weight:500;border:none;cursor:pointer}.mobile-nav-btn:hover{background:oklch(var(--color-primary)/.1);color:oklch(var(--color-primary))}.mobile-nav-btn.active{background:oklch(var(--color-primary));color:oklch(var(--color-primary-content))}.desktop-nav{display:flex;gap:1rem;align-items:center}.desktop-nav-btn{padding:.75rem 1rem;border-radius:.75rem;background:transparent;color:oklch(var(--color-base-content));text-decoration:none;transition:all .2s ease;font-size:1rem;font-weight:500;border:none;cursor:pointer;display:flex;align-items:center;gap:.5rem}.desktop-nav-btn:hover{background:oklch(var(--color-primary)/.1);color:oklch(var(--color-primary))}.desktop-nav-btn.active{background:oklch(var(--color-primary));color:oklch(var(--color-primary-content));box-shadow:0 4px 15px oklch(var(--color-primary)/.3)}.user-roll-display{background:oklch(var(--color-primary)/.1);color:oklch(var(--color-primary));padding:.5rem .75rem;border-radius:.5rem;font-size:.75rem;font-weight:600;font-family:'Courier New',monospace}.desktop-user-roll-display{background:oklch(var(--color-primary)/.1);color:oklch(var(--color-primary));padding:.75rem 1rem;border-radius:.75rem;font-size:.875rem;font-weight:600;font-family:'Courier New',monospace}.mobile-header-title{font-size:1rem;font-weight:600;color:oklch(var(--color-primary));display:flex;align-items:center;gap:.5rem}.desktop-header{background:oklch(var(--color-base-100)/.8);backdrop-filter:blur(10px);border-bottom:1px solid oklch(var(--color-base-300)/.3);box-shadow:0 4px 6px -1px oklch(var(--color-base-content)/.1)}.desktop-header-title{font-size:1.5rem;font-weight:700;color:oklch(var(--color-primary));display:flex;align-items:center;gap:.75rem}.app-layout{height:100vh;display:flex;flex-direction:column;overflow:hidden}.app-main{flex:1;padding:2rem;overflow-y:auto;max-height:calc(100vh - 15vh)}@media (min-width:769px){.drawer{display:block}.drawer-toggle{display:none}.drawer-content{display:block}.drawer-side{display:none}}.nav-item{transition:background-color .2s ease,color .2s ease;border-radius:12px;margin:4px 0;position:relative}.nav-item:hover{background:linear-gradient(135deg,oklch(var(--color-primary)/.1),oklch(var(--color-accent)/.1))}.nav-item.active{background:linear-gradient(135deg,oklch(var(--color-primary)),oklch(var(--color-accent)));color:oklch(var(--color-primary-content));box-shadow:0 4px 15px oklch(var(--color-primary)/.3)}.nav-item.active:hover{background:linear-gradient(135deg,oklch(var(--color-primary)),oklch(var(--color-accent)))}.theme-toggle-single{position:relative;width:140px;height:48px;background:linear-gradient(145deg,#f0f0f3,#cacaca);border-radius:24px;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:inset 2px 2px 5px rgba(0,0,0,.1),inset -2px -2px 5px rgba(255,255,255,.7),2px 2px 8px rgba(0,0,0,.15);border:none;display:flex;align-items:center;padding:4px;overflow:hidden}.theme-toggle-single.dark{background:linear-gradient(145deg,#2a2d3a,#1e1f2a);box-shadow:inset 2px 2px 5px rgba(0,0,0,.3),inset -2px -2px 5px rgba(255,255,255,.1),2px 2px 8px rgba(0,0,0,.4)}.theme-toggle-circle{position:absolute;width:40px;height:40px;background:linear-gradient(145deg,#fff,#e6e6e6);border-radius:50%;transition:all .4s cubic-bezier(.4,0,.2,1);box-shadow:2px 2px 6px rgba(0,0,0,.2),-1px -1px 3px rgba(255,255,255,.8);display:flex;align-items:center;justify-content:center;left:4px;z-index:2}.password-toggle{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:oklch(var(--color-base-content)/.6);transition:color .2s ease;z-index:10}.password-toggle:hover{color:oklch(var(--color-primary))}.password-toggle:focus{outline:none;color:oklch(var(--color-primary))}.input-with-toggle{padding-right:3rem!important}.theme-toggle-single.dark .theme-toggle-circle{transform:translateX(92px);background:linear-gradient(145deg,#4a4d5a,#3a3d4a);box-shadow:2px 2px 6px rgba(0,0,0,.4),-1px -1px 3px rgba(255,255,255,.1)}.theme-toggle-icon{width:18px;height:18px;transition:all .3s ease;color:#666}.theme-toggle-single.dark .theme-toggle-icon{color:#e6e6e6}.theme-toggle-text{position:absolute;font-size:12px;font-weight:600;letter-spacing:.5px;transition:all .3s ease;z-index:1}.theme-toggle-light-text{left:48px;color:#4a5568;opacity:1}.theme-toggle-dark-text{right:48px;color:#e2e8f0;opacity:0}.theme-toggle-single.dark .theme-toggle-light-text{opacity:0}.theme-toggle-single.dark .theme-toggle-dark-text{opacity:1}.theme-toggle-single-sm{width:100px;height:36px;border-radius:18px;padding:3px}.theme-toggle-circle-sm{width:30px;height:30px;left:3px}.theme-toggle-single-sm.dark .theme-toggle-circle-sm{transform:translateX(64px)}.theme-toggle-icon-sm{width:14px;height:14px}.theme-toggle-text-sm{font-size:10px}.theme-toggle-light-text-sm{left:36px}.theme-toggle-dark-text-sm{right:36px}.loading-overlay{background:oklch(var(--color-base-100)/.8);backdrop-filter:blur(5px)}.table-enhanced{backdrop-filter:blur(10px);background:oklch(var(--color-base-100)/.6)}.table-enhanced th{background:oklch(var(--color-base-200)/.95);backdrop-filter:blur(8px);color:oklch(var(--color-base-content));font-weight:600;padding:16px;border-bottom:2px solid oklch(var(--color-base-300)/.5)}.table-enhanced tr:hover{background:oklch(var(--color-primary)/.05);transform:scale(1.01);transition:all .2s ease}.sticky-header{position:sticky;top:0;background:oklch(var(--color-base-100)/.95);backdrop-filter:blur(8px);z-index:10;border-bottom:1px solid oklch(var(--color-base-300)/.3)}.dashboard-container{position:relative;height:calc(100vh - 120px);overflow:hidden}.forms-table-container{max-height:calc(100vh - 300px);overflow-y:auto;border-radius:12px;border:1px solid oklch(var(--color-base-300)/.3)}@media (max-width:768px){.mobile-card{margin:8px;border-radius:16px}.mobile-padding{padding:16px}.mobile-text-responsive{font-size:clamp(14px,2.5vw,16px)}.desktop-header{display:none}.app-main{padding:1rem}.forms-table-container{max-height:calc(100vh - 250px)}.sticky-header{margin-left:-1rem;margin-right:-1rem;margin-top:-1rem;padding-left:1rem;padding-right:1rem;padding-top:1rem}}@media (min-width:769px){.mobile-nav-header{display:none!important}.desktop-header .navbar{padding:1rem 2rem}.desktop-nav{margin:0 2rem}}*{scrollbar-width:none;-ms-overflow-style:none}*::-webkit-scrollbar{display:none}.scrollable{overflow-y:auto;overflow-x:hidden;max-height:calc(100vh - 10px)}.gradient-bg{background:linear-gradient(135deg,oklch(var(--color-primary)/.1) 0%,oklch(var(--color-secondary)/.1) 50%,oklch(var(--color-accent)/.1) 100%)}.gradient-primary{background:linear-gradient(135deg,oklch(var(--color-primary)),oklch(var(--color-accent)))}.badge-enhanced{background:oklch(var(--color-base-200)/.8);color:oklch(var(--color-base-content));border:1px solid oklch(var(--color-base-300)/.5);backdrop-filter:blur(5px);font-weight:500}.modal-enhanced{backdrop-filter:blur(8px);background:oklch(var(--color-base-content)/.3)}.modal-box-enhanced{background:oklch(var(--color-base-100));border:1px solid oklch(var(--color-base-300)/.3);box-shadow:0 25px 50px oklch(var(--color-base-content)/.25)}.no-default{-webkit-appearance:none;-moz-appearance:none;appearance:none}.no-default:focus{outline:none}button.no-default,input[type="submit"].no-default,input[type="button"].no-default{background:none;border:none;padding:0;margin:0;font:inherit;color:inherit;cursor:pointer}.sign-in-container{height:100vh;overflow-y:auto}</style></head><body><div id="signInSection" class="sign-in-container flex items-center justify-center p-4 gradient-bg"><div class="card w-full max-w-md mx-auto card-enhanced fade-in"><div class="card-body p-8"><div class="w-20 h-20 gradient-primary rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg"><i data-lucide="graduation-cap" class="w-12 h-12 text-blue"></i></div><div class="flex justify-center mb-4"><button class="theme-toggle-single" id="signInThemeToggle" type="button"><div class="theme-toggle-circle"><i data-lucide="sun" class="theme-toggle-icon"></i></div><span class="theme-toggle-text theme-toggle-light-text">LIGHT MODE</span><span class="theme-toggle-text theme-toggle-dark-text">DARK MODE</span></button></div><div class="space-y-6"><div class="text-center mb-8"><h2 class="text-3xl font-bold text-base-content mb-2">CSE Placement Portal</h2><p class="text-base-content/60">Sign in to access your placement dashboard</p></div><div class="space-y-6"><div class="form-control"><label class="label"><span class="label-text font-medium text-base-content">Roll Number</span></label><div class="relative"><div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"><i data-lucide="user" class="w-5 h-5 text-base-content/40"></i></div><input type="text" id="rollNo" placeholder="Enter your roll number" class="input input-bordered input-enhanced w-full pl-12 h-12 text-base no-default" autocomplete="username" required/></div></div><div class="form-control"><label class="label"><span class="label-text font-medium text-base-content">Password</span></label><div class="relative"><div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none"><i data-lucide="lock" class="w-5 h-5 text-base-content/40"></i></div><input type="password" id="password" placeholder="Enter your password" class="input input-bordered input-enhanced w-full pl-12 pr-12 h-12 text-base no-default input-with-toggle" autocomplete="current-password" required/><button type="button" class="password-toggle no-default" onclick="togglePasswordVisibility('password')" aria-label="Toggle password visibility"><i data-lucide="eye" class="w-5 h-5" id="password-toggle-icon"></i></button></div></div></div><div class="flex justify-between items-center"><button type="button" id="forgotPassLink" class="text-sm link link-hover text-primary font-medium no-default">Forgot Password?</button></div><button id="signInBtn" type="button" class="btn btn-primary btn-enhanced w-full h-12 text-base font-medium no-default"><span class="hidden loading loading-spinner loading-sm"></span><i data-lucide="log-in" class="w-5 h-5 mr-2"></i>Sign In</button><div id="signInMessage" class="text-sm text-center min-h-6 font-medium"></div></div></div></div></div><div id="appShell" class="app-layout hidden"><div class="mobile-nav-header bg-base-100/80 backdrop-blur-md shadow-sm border-b border-base-300/30 md:hidden"><div class="navbar"><div class="flex-1 flex items-center justify-between"><div class="mobile-header-title"><i data-lucide="graduation-cap" class="w-5 h-5"></i>CSE Placement Portal</div><div class="mobile-nav"><button id="mobileNavDashboard" type="button" class="mobile-nav-btn no-default"><i data-lucide="layout-dashboard" class="w-4 h-4 mr-1"></i>Dashboard</button><button id="mobileNavProfile" type="button" class="mobile-nav-btn no-default"><i data-lucide="user" class="w-4 h-4 mr-1"></i>Profile</button></div></div><div class="flex-none flex items-center gap-3"><button class="theme-toggle-single theme-toggle-single-sm" id="mobileThemeToggle" type="button"><div class="theme-toggle-circle theme-toggle-circle-sm"><i data-lucide="sun" class="theme-toggle-icon theme-toggle-icon-sm"></i></div><span class="theme-toggle-text theme-toggle-text-sm theme-toggle-light-text theme-toggle-light-text-sm">LIGHT</span><span class="theme-toggle-text theme-toggle-text-sm theme-toggle-dark-text theme-toggle-dark-text-sm">DARK</span></button><div class="user-roll-display" id="mobileUserRoll">JVP555</div><button id="mobileSignOut" type="button" class="btn btn-ghost btn-sm text-error no-default"><i data-lucide="log-out" class="w-4 h-4"></i></button></div></div></div><div class="desktop-header hidden md:block"><div class="navbar max-w-7xl mx-auto px-8"><div class="flex-1"><div class="desktop-header-title"><i data-lucide="graduation-cap" class="w-8 h-8"></i>CSE Placement Portal</div></div><div class="flex-none"><div class="desktop-nav"><button id="desktopNavDashboard" type="button" class="desktop-nav-btn no-default"><i data-lucide="layout-dashboard" class="w-5 h-5"></i>Dashboard</button><button id="desktopNavProfile" type="button" class="desktop-nav-btn no-default"><i data-lucide="user" class="w-5 h-5"></i>My Profile</button></div></div><div class="flex-none flex items-center gap-4"><button class="theme-toggle-single" id="desktopThemeToggle" type="button"><div class="theme-toggle-circle"><i data-lucide="sun" class="theme-toggle-icon"></i></div><span class="theme-toggle-text theme-toggle-light-text">LIGHT MODE</span><span class="theme-toggle-text theme-toggle-dark-text">DARK MODE</span></button><div class="desktop-user-roll-display" id="desktopUserRoll">JVP555</div><button id="desktopSignOut" type="button" class="btn btn-error btn-enhanced no-default"><i data-lucide="log-out" class="w-4 h-4 mr-2"></i>Sign Out</button></div></div></div><main class="app-main gradient-bg scrollable"><div class="w-full max-w-7xl mx-auto"><div id="profileView" class="hidden fade-in"><div class="card card-enhanced"><div class="card-body p-6 lg:p-8"><div class="flex flex-col lg:flex-row lg:justify-between lg:items-center mb-8"><div><h2 class="text-3xl font-bold text-base-content">My Profile</h2><p class="text-base-content/60 mt-2">Manage your personal information and settings</p></div><div class="mt-4 lg:mt-0"><div class="badge badge-enhanced badge-lg"><i data-lucide="user-check" class="w-4 h-4 mr-2"></i>Verified Student</div></div></div><div role="tablist" class="tabs tabs-bordered tabs-lg mb-8"><button id="profileTab" role="tab" class="tab tab-active font-medium no-default" type="button"><i data-lucide="user" class="w-4 h-4 mr-2"></i>Personal Details</button><button id="passwordTab" role="tab" class="tab font-medium no-default" type="button"><i data-lucide="key" class="w-4 h-4 mr-2 ml-4"></i>Security</button></div><div id="profileMessage" class="mb-6"></div><div id="profileTabContent"><div id="profileLoading" class="text-center py-16 loading-overlay rounded-lg"><span class="loading loading-dots loading-lg text-primary"></span><p class="mt-4 text-base-content/60">Loading your profile...</p></div><div id="profileContent" class="hidden grid grid-cols-1 lg:grid-cols-2 gap-6"></div><div class="flex flex-wrap gap-3 justify-end mt-8"><button id="profileEditBtn" type="button" class="btn btn-secondary btn-enhanced no-default"><i data-lucide="edit-3" class="w-4 h-4 mr-2"></i>Edit Details</button><button id="profileCancelBtn" type="button" class="btn btn-ghost btn-enhanced hidden no-default"><i data-lucide="x" class="w-4 h-4 mr-2"></i>Cancel</button><button id="profileSubmitBtn" type="button" class="btn btn-primary btn-enhanced hidden no-default"><span class="hidden loading loading-spinner loading-sm"></span><i data-lucide="save" class="w-4 h-4 mr-2"></i>Save Changes</button></div></div><div id="passwordTabContent" class="hidden"><div class="max-w-md mx-auto"><div class="bg-warning/10 border border-warning/20 rounded-lg p-4 mb-6"><div class="flex items-start gap-3"><i data-lucide="shield-alert" class="w-5 h-5 text-warning mt-0.5"></i><div><h4 class="font-medium text-warning">Security Notice</h4><p class="text-sm text-base-content/60 mt-1">Choose a strong password with at least 6 characters.</p></div></div></div><div class="space-y-6"><div id="passwordChangeMessage" class="mb-6"></div><div class="space-y-6"><div class="form-control"><label class="label"><span class="label-text font-medium">New Password</span></label><div class="relative"><input type="text" name="username" autocomplete="username" value=" " hidden/><input type="password" id="newPassword" placeholder="Enter new password" class="input input-bordered input-enhanced w-full pr-12 no-default input-with-toggle" autocomplete="new-password" minlength="6" required/><button type="button" class="password-toggle no-default" onclick="togglePasswordVisibility('newPassword')" aria-label="Toggle new password visibility"><i data-lucide="eye" class="w-5 h-5" id="newPassword-toggle-icon"></i></button></div></div><div class="form-control"><label class="label"><span class="label-text font-medium">Confirm New Password</span></label><div class="relative"><input type="password" id="confirmNewPassword" placeholder="Confirm new password" class="input input-bordered input-enhanced w-full pr-12 no-default input-with-toggle" autocomplete="new-password" minlength="6" required/><button type="button" class="password-toggle no-default" onclick="togglePasswordVisibility('confirmNewPassword')" aria-label="Toggle confirm password visibility"><i data-lucide="eye" class="w-5 h-5" id="confirmNewPassword-toggle-icon"></i></button></div></div></div><button id="passwordSubmitBtn" type="button" class="btn btn-primary btn-enhanced w-full no-default"><span class="hidden loading loading-spinner loading-sm"></span><i data-lucide="shield-check" class="w-4 h-4 mr-2"></i>Update Password</button></div></div></div></div></div></div><div id="dashboardView" class="hidden fade-in"><div class="card card-enhanced"><div class="card-body p-6 lg:p-8"><div class="sticky top-0 bg-base-100/95 backdrop-blur-sm z-10 -mx-6 -mt-6 px-6 pt-6 pb-4 border-b border-base-300/30 mb-6"><div class="flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4"><div><h2 class="text-3xl font-bold text-base-content">Available Forms</h2><p class="text-base-content/60 mt-2">Manage your placement applications and submissions</p></div><div class="flex flex-wrap gap-3"><div class="badge badge-enhanced badge-lg"><i data-lucide="calendar" class="w-4 h-4 mr-2"></i>B.Tech Academic Year 2023-27</div><div class="badge badge-primary badge-lg"><i data-lucide="trending-up" class="w-4 h-4 mr-2"></i>Active Student</div></div></div><div id="dashboardMessage" class="mt-4"></div></div><div class="forms-table-container"><table class="table table-zebra w-full table-enhanced"><thead class="sticky top-0 z-20 bg-base-200/95 backdrop-blur-sm"><tr><th class="font-semibold text-base bg-base-200/95 backdrop-blur-sm"><i data-lucide="file-text" class="w-4 h-4 mr-2 inline"></i>Form Name</th><th class="font-semibold text-base bg-base-200/95 backdrop-blur-sm"><i data-lucide="activity" class="w-4 h-4 mr-2 inline"></i>Status</th><th class="font-semibold text-base bg-base-200/95 backdrop-blur-sm"><i data-lucide="clock" class="w-4 h-4 mr-2 inline"></i>Deadline</th><th class="font-semibold text-base bg-base-200/95 backdrop-blur-sm"><i data-lucide="check-circle" class="w-4 h-4 mr-2 inline"></i>Submission</th><th class="font-semibold text-base bg-base-200/95 backdrop-blur-sm"><i data-lucide="settings" class="w-4 h-4 mr-2 inline"></i>Action</th></tr></thead><tbody id="formsTbody"></tbody></table></div></div></div></div><div id="formView" class="hidden fade-in"><div class="card card-enhanced"><div class="card-body p-6 lg:p-8"><div class="mb-6"><button id="backToDashboardBtn" type="button" class="btn btn-ghost btn-sm btn-enhanced no-default"><i data-lucide="arrow-left" class="w-4 h-4 mr-2"></i>Back to Dashboard</button></div><div class="grid grid-cols-1 xl:grid-cols-2 gap-8"><div id="detailsPane" class="space-y-6"><div class="bg-base-200/50 rounded-lg p-6 border border-base-300/30"><h2 id="formTitle" class="text-3xl font-bold text-base-content mb-4">Loading...</h2><div class="flex flex-wrap items-center gap-4 text-sm text-base-content/60 mb-6"><span id="openStatus"></span><span id="deadlineText"></span><span id="countdownText" class="font-mono bg-primary/10 text-primary px-3 py-1 rounded-full"></span></div><div id="formDescription" class="prose max-w-none text-base-content/80"></div><div id="fileDownloadArea" class="mt-6"></div></div></div><div class="space-y-6 overflow-y-auto scrollable" style="max-height:calc(100vh - 150px);"><div id="closedBanner" class="hidden alert alert-warning"><i data-lucide="alert-triangle" class="w-5 h-5"></i><span>This form is not currently accepting responses.</span></div><div id="detailsSection" class="hidden"><h3 class="text-xl font-semibold text-base-content mb-4"><i data-lucide="user-check" class="w-5 h-5 mr-2 inline"></i>Your Details</h3><div id="studentData" class="bg-base-200/50 p-4 rounded-lg border border-base-300/30"></div></div><div id="customDivider" class="hidden divider"><i data-lucide="edit" class="w-4 h-4"></i></div><div id="customSection" class="hidden"><h3 class="text-xl font-semibold text-base-content mb-4"><i data-lucide="clipboard-list" class="w-5 h-5 mr-2 inline"></i>Additional Information</h3><div id="customFieldsContainer" class="space-y-4"></div></div><div id="actionSection" class="hidden"><div class="bg-base-200/50 p-6 rounded-lg border border-base-300/30"><div class="flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4 mb-4"><div id="currentStatus" class="font-medium text-base-content"></div><div class="flex gap-3"><button id="withdrawBtn" type="button" class="btn btn-warning btn-enhanced hidden no-default"><i data-lucide="x-circle" class="w-4 h-4 mr-2"></i>Withdraw</button><button id="submitBtn" type="button" class="btn btn-primary btn-enhanced no-default"><span class="hidden loading loading-spinner loading-sm"></span><i data-lucide="send" class="w-4 h-4 mr-2"></i>Submit Application</button></div></div><div id="result" class="text-sm text-center min-h-6"></div></div></div></div></div></div></div></div></div></main></div><dialog id="successModal" class="modal modal-enhanced"><div class="modal-box modal-box-enhanced"><div class="text-center mb-6"><div class="w-16 h-16 bg-success/10 text-success rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="check-circle" class="w-8 h-8"></i></div><h3 id="successModalTitle" class="font-bold text-lg text-success">Success</h3></div><p id="successModalMessage" class="text-center mb-6">Operation completed successfully.</p><div class="modal-action justify-center"><button type="button" class="btn btn-success btn-enhanced no-default" onclick="this.closest('dialog').close()"><i data-lucide="check" class="w-4 h-4 mr-2"></i>Great!</button></div></div></dialog><dialog id="forgotPassModal" class="modal modal-enhanced"><div class="modal-box modal-box-enhanced max-w-md"><div class="text-center mb-6"><div class="w-16 h-16 gradient-primary rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="key" class="w-8 h-8 text-white"></i></div><h3 class="font-bold text-xl">Forgot Password</h3><p class="text-base-content/60 mt-2">Enter your Roll Number to receive your password at your registered email address.</p></div><div class="space-y-6"><div class="form-control"><label class="label"><span class="label-text font-medium">Roll Number</span></label><input type="text" id="forgotRollNo" placeholder="Enter your roll number" class="input input-bordered input-enhanced w-full no-default"/></div><button id="sendPassBtn" type="button" class="btn btn-primary btn-enhanced w-full no-default"><span class="hidden loading loading-spinner loading-sm"></span><i data-lucide="send" class="w-4 h-4 mr-2"></i>Send Password</button><div id="forgotPassMessage" class="text-sm text-center min-h-6 font-medium"></div></div><div class="modal-action"><button type="button" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2 no-default" onclick="this.closest('dialog').close()"><i data-lucide="x" class="w-4 h-4"></i></button></div></div></dialog><dialog id="alertModal" class="modal modal-enhanced"><div class="modal-box modal-box-enhanced"><div class="text-center mb-6"><div class="w-16 h-16 bg-error/10 text-error rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="alert-circle" class="w-8 h-8"></i></div><h3 id="alertModalTitle" class="font-bold text-lg">Error</h3></div><p id="alertModalMessage" class="text-center mb-6">An unexpected error occurred.</p><div class="modal-action justify-center"><button type="button" class="btn btn-primary btn-enhanced no-default" onclick="this.closest('dialog').close()"><i data-lucide="check" class="w-4 h-4 mr-2"></i>Close</button></div></div></dialog><dialog id="confirmModal" class="modal modal-enhanced"><div class="modal-box modal-box-enhanced"><div class="text-center mb-6"><div class="w-16 h-16 bg-warning/10 text-warning rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="help-circle" class="w-8 h-8"></i></div><h3 id="confirmModalTitle" class="font-bold text-lg">Are you sure?</h3></div><p id="confirmModalMessage" class="text-center mb-6">This action cannot be undone.</p><div class="modal-action justify-center gap-3"><button id="confirmModalCancelBtn" type="button" class="btn btn-ghost btn-enhanced no-default"><i data-lucide="x" class="w-4 h-4 mr-2"></i>Cancel</button><button id="confirmModalOkBtn" type="button" class="btn btn-error btn-enhanced no-default"><i data-lucide="check" class="w-4 h-4 mr-2"></i>Confirm</button></div></div></dialog><dialog id="submitConfirmModal" class="modal modal-enhanced"><div class="modal-box modal-box-enhanced"><div class="text-center mb-6"><div class="w-16 h-16 bg-primary/10 text-primary rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="send" class="w-8 h-8"></i></div><h3 class="font-bold text-lg">Submit Application</h3></div><p class="text-center mb-6">Are you sure you want to submit your application? This action cannot be undone.</p><div class="modal-action justify-center gap-3"><button id="submitConfirmCancelBtn" type="button" class="btn btn-ghost btn-enhanced no-default"><i data-lucide="x" class="w-4 h-4 mr-2"></i>Cancel</button><button id="submitConfirmOkBtn" type="button" class="btn btn-primary btn-enhanced no-default"><i data-lucide="send" class="w-4 h-4 mr-2"></i>Submit</button></div></div></dialog><dialog id="signOutConfirmModal" class="modal modal-enhanced"><div class="modal-box modal-box-enhanced"><div class="text-center mb-6"><div class="w-16 h-16 bg-error/10 text-error rounded-full flex items-center justify-center mx-auto mb-4"><i data-lucide="log-out" class="w-8 h-8"></i></div><h3 class="font-bold text-lg">Sign Out</h3></div><p class="text-center mb-6">Are you sure you want to sign out? You will need to sign in again to access your account.</p><div class="modal-action justify-center gap-3"><button id="signOutConfirmCancelBtn" type="button" class="btn btn-ghost btn-enhanced no-default"><i data-lucide="x" class="w-4 h-4 mr-2"></i>Cancel</button><button id="signOutConfirmOkBtn" type="button" class="btn btn-error btn-enhanced no-default"><i data-lucide="log-out" class="w-4 h-4 mr-2"></i>Sign Out</button></div></div></dialog><script>document.addEventListener('submit',function(e){e.preventDefault();e.stopPropagation();return false});document.addEventListener('click',function(e){if(e.target.tagName==='A'&&e.target.getAttribute('href')==='#'){e.preventDefault();e.stopPropagation()}});window.confirm=function(message){console.warn("Default confirm() blocked. Use showCustomConfirm() instead.");return false};window.alert=function(message){console.warn("Default alert() blocked. Use showAlert() instead.");showAlert(message,"Alert")};function showCustomConfirm(message,title,callback,type="warning"){const modal=document.getElementById("confirmModal");const titleEl=document.getElementById("confirmModalTitle");const msgEl=document.getElementById("confirmModalMessage");const okBtn=document.getElementById("confirmModalOkBtn");const cancelBtn=document.getElementById("confirmModalCancelBtn");if(titleEl&&msgEl&&modal&&okBtn&&cancelBtn){titleEl.textContent=title;msgEl.innerText=message;if(type==="primary"){okBtn.className="btn btn-primary btn-enhanced no-default"}else if(type==="error"){okBtn.className="btn btn-error btn-enhanced no-default"}else{okBtn.className="btn btn-warning btn-enhanced no-default"}const onOkClick=()=>{modal.close();cleanup();callback(true)};const onCancelClick=()=>{modal.close();cleanup();callback(false)};const cleanup=()=>{okBtn.removeEventListener("click",onOkClick);cancelBtn.removeEventListener("click",onCancelClick)};okBtn.addEventListener("click",onOkClick,{once:true});cancelBtn.addEventListener("click",onCancelClick,{once:true});modal.showModal()}else{callback(true)}}function showSubmitConfirm(callback){const modal=document.getElementById("submitConfirmModal");const okBtn=document.getElementById("submitConfirmOkBtn");const cancelBtn=document.getElementById("submitConfirmCancelBtn");if(modal&&okBtn&&cancelBtn){const onOkClick=()=>{modal.close();cleanup();callback(true)};const onCancelClick=()=>{modal.close();cleanup();callback(false)};const cleanup=()=>{okBtn.removeEventListener("click",onOkClick);cancelBtn.removeEventListener("click",onCancelClick)};okBtn.addEventListener("click",onOkClick,{once:true});cancelBtn.addEventListener("click",onCancelClick,{once:true});modal.showModal()}else{callback(true)}}function showSignOutConfirm(callback){const modal=document.getElementById("signOutConfirmModal");const okBtn=document.getElementById("signOutConfirmOkBtn");const cancelBtn=document.getElementById("signOutConfirmCancelBtn");if(modal&&okBtn&&cancelBtn){const onOkClick=()=>{modal.close();cleanup();callback(true)};const onCancelClick=()=>{modal.close();cleanup();callback(false)};const cleanup=()=>{okBtn.removeEventListener("click",onOkClick);cancelBtn.removeEventListener("click",onCancelClick)};okBtn.addEventListener("click",onOkClick,{once:true});cancelBtn.addEventListener("click",onCancelClick,{once:true});modal.showModal()}else{callback(true)}}const SERVER_FORM_NAME=<?!=JSON.stringify(formNameFromServer||"")?>;let currentFormName=SERVER_FORM_NAME;let session={rollNo:"JVP555",sessionToken:null,rowID:null,loginTimestamp:0};let formConfig={};let fieldsConfig=[];let countdownTimer=null;let sessionInterval=null;let studentEditableFields=[];const signInBtn=document.getElementById("signInBtn");const signInSpinner=signInBtn?.querySelector(".loading");function initTheme(){const savedTheme=localStorage.getItem('theme')||'pastel';document.documentElement.setAttribute('data-theme',savedTheme);updateThemeToggles()}function setTheme(theme){document.documentElement.setAttribute('data-theme',theme);localStorage.setItem('theme',theme);updateThemeToggles()}function updateThemeToggles(){const theme=document.documentElement.getAttribute('data-theme');const isDark=theme==='dark';const toggles=['signInThemeToggle','mobileThemeToggle','desktopThemeToggle'];toggles.forEach(id=>{const toggle=document.getElementById(id);const icon=toggle?.querySelector('.theme-toggle-icon');if(toggle&&icon){toggle.classList.toggle('dark',isDark);if(isDark){icon.setAttribute('data-lucide','moon')}else{icon.setAttribute('data-lucide','sun')}}});lucide.createIcons()}function show(id){const el=document.getElementById(id);if(el){el.classList.remove("hidden");el.classList.add("fade-in");setTimeout(()=>el.classList.remove("fade-in"),400)}}function hide(id){const el=document.getElementById(id);if(el){el.classList.add("hidden");el.classList.remove("fade-in")}}function showAlert(message,title="Error",isError=true){const modal=isError?document.getElementById("alertModal"):document.getElementById("successModal");const titleEl=modal.querySelector('h3');const msgEl=modal.querySelector('p');const iconEl=modal.querySelector('.w-16 i');if(titleEl&&msgEl&&modal&&iconEl){titleEl.textContent=title;msgEl.innerText=message;const iconContainer=iconEl.parentElement;if(isError){iconContainer.className="w-16 h-16 bg-error/10 text-error rounded-full flex items-center justify-center mx-auto mb-4";iconEl.setAttribute('data-lucide','alert-circle');titleEl.className="font-bold text-lg text-error"}else{iconContainer.className="w-16 h-16 bg-success/10 text-success rounded-full flex items-center justify-center mx-auto mb-4";iconEl.setAttribute('data-lucide','check-circle');titleEl.className="font-bold text-lg text-success"}lucide.createIcons();modal.showModal()}}function showConfirm(message,title="Are you sure?",okButtonType="btn-error"){const titleEl=document.getElementById("confirmModalTitle");const msgEl=document.getElementById("confirmModalMessage");const modal=document.getElementById("confirmModal");const okBtn=document.getElementById("confirmModalOkBtn");const cancelBtn=document.getElementById("confirmModalCancelBtn");if(!titleEl||!msgEl||!modal||!okBtn||!cancelBtn){return Promise.resolve(true)}titleEl.textContent=title;msgEl.innerText=message;okBtn.className=`btn ${okButtonType} btn-enhanced no-default`;return new Promise((resolve)=>{const onOkClick=()=>{modal.close();cleanup();resolve(true)};const onCancelClick=()=>{modal.close();cleanup();resolve(false)};const cleanup=()=>{okBtn.removeEventListener("click",onOkClick);cancelBtn.removeEventListener("click",onCancelClick)};okBtn.addEventListener("click",onOkClick,{once:true});cancelBtn.addEventListener("click",onCancelClick,{once:true});modal.showModal()})}function fmtDateTime(ms){if(!ms)return "—";try{const d=new Date(ms);if(isNaN(d.getTime()))return "—";return d.toLocaleString()}catch{return "—"}}function setLoading(isLoading){if(signInBtn){signInBtn.disabled=isLoading;if(signInSpinner){signInSpinner.classList.toggle("hidden",!isLoading)}}}function updateUserInfo(rollNo){const mobileEl=document.getElementById("mobileUserRoll");if(mobileEl&&rollNo){mobileEl.textContent=rollNo}const desktopEl=document.getElementById("desktopUserRoll");if(desktopEl&&rollNo){desktopEl.textContent=rollNo}}function updateActiveNav(activeId){document.querySelectorAll('.mobile-nav-btn, .desktop-nav-btn').forEach(item=>{item.classList.remove('active')});if(activeId==='navDashboard'){document.getElementById('mobileNavDashboard')?.classList.add('active');document.getElementById('desktopNavDashboard')?.classList.add('active')}else if(activeId==='navProfile'){document.getElementById('mobileNavProfile')?.classList.add('active');document.getElementById('desktopNavProfile')?.classList.add('active')}}function handleFailure(err){const msgEl=document.getElementById("signInMessage")||document.getElementById("result")||document.getElementById("dashboardMessage");if(msgEl){msgEl.innerHTML=`<div class="alert alert-error"><span>❌ Server Error: ${err.message}</span></div>`}setLoading(false)}function createSuccessHandler(funcName,callback){return(response)=>{if(typeof response!=="object"&&response!==null){showAlert(`A critical server error occurred (${funcName}). Check console.`,"Critical Server Error");handleFailure({message:`Invalid response from ${funcName}.`});return}callback(response)}}function signIn(){const rollNo=document.getElementById("rollNo").value.trim();const password=document.getElementById("password").value.trim();const msgEl=document.getElementById("signInMessage");if(!rollNo||!password){msgEl.innerHTML='<div class="alert alert-warning"><span>Please enter both Roll Number and Password.</span></div>';return}msgEl.innerHTML="";setLoading(true);google.script.run.withSuccessHandler(createSuccessHandler("signIn",(response)=>{setLoading(false);if(response&&!response.error&&response.sessionToken){sessionStorage.setItem("rollNo",rollNo);sessionStorage.setItem("sessionToken",response.sessionToken);sessionStorage.setItem("rowID",response.rowID);sessionStorage.setItem("loginTimestamp",Date.now());sessionStorage.setItem("tokenExpiry",response.expiry);Object.assign(session,{rollNo:rollNo,sessionToken:response.sessionToken,rowID:response.rowID,loginTimestamp:Date.now()});document.getElementById("password").value="";updateUserInfo(rollNo);hide("signInSection");show("appShell");showAlert("Welcome to the CSE Placement Portal!","Login Successful",false);const params=new URLSearchParams(window.location.search);const urlFormName=params.get("formName");if(urlFormName){currentFormName=urlFormName;history.replaceState(null,"","/")}showDashboard()}else{msgEl.innerHTML=`<div class="alert alert-error"><span>${(response&&response.error)||"Sign-in failed. Please check your credentials."}</span></div>`}})).withFailureHandler(handleFailure).authenticateAndGetToken(rollNo,password)}function signOut(showConfirmation=true){const performSignOut=()=>{if(session.rollNo&&session.sessionToken){google.script.run.withSuccessHandler(()=>{console.log("Session invalidated on server")}).withFailureHandler(()=>{console.log("Failed to invalidate session on server")}).invalidateSessionToken(session.rollNo)}sessionStorage.clear();session={rollNo:null,sessionToken:null,rowID:null,loginTimestamp:0};currentFormName=SERVER_FORM_NAME;const rollEl=document.getElementById("rollNo");if(rollEl)rollEl.value="";const passEl=document.getElementById("password");if(passEl)passEl.value="";const msgEl=document.getElementById("signInMessage");if(msgEl)msgEl.innerHTML="";hide("dashboardView");hide("formView");hide("profileView");hide("appShell");show("signInSection");if(sessionInterval)clearInterval(sessionInterval);if(countdownTimer)clearInterval(countdownTimer);if(showConfirmation){showAlert("You have been signed out successfully.","Signed Out",false)}};const signInSection=document.getElementById("signInSection");const appShell=document.getElementById("appShell");const isOnSignInPage=signInSection&&!signInSection.classList.contains("hidden")&&appShell&&appShell.classList.contains("hidden");if(isOnSignInPage){performSignOut();return}if(showConfirmation){showSignOutConfirm((confirmed)=>{if(!confirmed)return;performSignOut()})}else{performSignOut()}}function loadFormView(formName){if(!formName)return;currentFormName=formName;const newUrl=window.location.pathname+"?formName="+encodeURIComponent(formName);history.pushState({formName:formName},"",newUrl);initPage()}function showDashboard(){currentFormName="";if(countdownTimer)clearInterval(countdownTimer);if(window.location.search!==""){history.pushState(null,"","/")}updateActiveNav("navDashboard");hide("formView");hide("profileView");show("dashboardView");loadDashboard()}function showProfile(){hide("dashboardView");hide("formView");show("profileView");if(countdownTimer)clearInterval(countdownTimer);updateActiveNav("navProfile");loadProfile();document.getElementById("newPassword").value="";document.getElementById("confirmNewPassword").value="";const pwMsgEl=document.getElementById("passwordChangeMessage");if(pwMsgEl)pwMsgEl.innerHTML="";const profileTab=document.getElementById("profileTab");const passwordTab=document.getElementById("passwordTab");if(profileTab&&passwordTab){profileTab.classList.add("tab-active");passwordTab.classList.remove("tab-active")}show("profileTabContent");hide("passwordTabContent")}function initPage(){try{session.rollNo=sessionStorage.getItem("rollNo");session.sessionToken=sessionStorage.getItem("sessionToken");session.rowID=sessionStorage.getItem("rowID");session.loginTimestamp=Number(sessionStorage.getItem("loginTimestamp"));const tokenExpiry=Number(sessionStorage.getItem("tokenExpiry"));if(session.rollNo&&session.sessionToken&&session.rowID&&session.loginTimestamp&&tokenExpiry>Date.now()){hide("signInSection");show("appShell");lucide.createIcons();startSessionTimer();updateUserInfo(session.rollNo);if(currentFormName){hide("dashboardView");hide("profileView");show("formView");loadFormConfig()}else{showDashboard()}}else{signOut()}}catch(err){console.error("Initialization error:",err);showAlert("A critical error occurred initializing the page. Please try refreshing.","Critical Error");signOut()}}function startSessionTimer(){if(sessionInterval)clearInterval(sessionInterval)}function loadDashboard(){const tbody=document.getElementById("formsTbody");const msgEl=document.getElementById("dashboardMessage");if(!tbody)return;if(msgEl)msgEl.innerHTML="";tbody.innerHTML=`<tr><td colspan="5" class="text-center p-8"><div class="loading-overlay rounded-lg p-8"><span class="loading loading-dots loading-lg text-primary"></span><p class="mt-4 text-base-content/60">Loading forms...</p></div></td></tr>`;google.script.run.withSuccessHandler(createSuccessHandler("loadDashboard",(response)=>{if(!response){tbody.innerHTML="";if(msgEl){msgEl.innerHTML=`<div class="alert alert-error"><span>Server error: Received no data. Try signing out and back in.</span></div>`}setTimeout(signOut,4000);return}if(response.error){tbody.innerHTML="";if(msgEl){msgEl.innerHTML=`<div class="alert alert-error"><span>Auth Error: ${response.error}. Try signing out and back in.</span></div>`}setTimeout(signOut,4000);return}tbody.innerHTML="";if(!response.forms||response.forms.length===0){tbody.innerHTML=`<tr><td colspan="5" class="text-center py-12"><div class="text-center"><i data-lucide="inbox" class="w-12 h-12 text-base-content/40 mx-auto mb-4"></i><p class="text-base-content/60">No forms are available at this time.</p></div></td></tr>`;updateQuickStats(0,0,0);return}response.forms.sort((a,b)=>b.isOpen-a.isOpen||(a.deadlineMs||Infinity)-(b.deadlineMs||Infinity));let totalForms=response.forms.length;let submittedCount=0;let pendingCount=0;response.forms.forEach((form)=>{let actionHtml=`<button class="btn btn-sm btn-ghost" disabled>Closed</button>`;if(form.submitted&&form.interested==="Yes"&&form.isOpen){actionHtml=`<button data-action="withdraw" data-form-name="${form.formName}" class="btn btn-sm btn-warning btn-enhanced no-default" type="button"><i data-lucide="x-circle" class="w-3 h-3 mr-1"></i>Withdraw</button>`;submittedCount++}else if(form.isOpen){actionHtml=`<button data-action="view" data-form-name="${form.formName}" class="btn btn-sm btn-primary btn-enhanced no-default" type="button"><i data-lucide="eye" class="w-3 h-3 mr-1"></i>View Form</button>`;pendingCount++}let statusHtml='<div class="badge badge-ghost">Not Submitted</div>';if(form.submitted){if(form.interested==="Yes"){statusHtml='<div class="badge badge-info">Interested</div>'}else if(form.interested==="Withdrawn"){statusHtml='<div class="badge badge-warning">Withdrawn</div>'}}const tr=document.createElement("tr");tr.className="hover:bg-primary/5 transition-all duration-200";tr.innerHTML=`<td class="font-semibold text-base-content">${form.formName}</td><td><div class="badge ${form.isOpen?"badge-success":"badge-error"} badge-outline"><i data-lucide="${form.isOpen?"check-circle":"x-circle"}" class="w-3 h-3 mr-1"></i>${form.isOpen?"Open":"Closed"}</div></td><td class="text-base-content/70">${fmtDateTime(form.deadlineMs)}</td><td>${statusHtml}</td><td>${actionHtml}</td>`;tbody.appendChild(tr)});updateQuickStats(totalForms,submittedCount,pendingCount);lucide.createIcons()})).withFailureHandler(handleFailure).getStudentFormsStatusWithToken(session.rollNo,session.sessionToken)}function updateQuickStats(total,submitted,pending){const totalEl=document.getElementById("statsFormsCount");const submittedEl=document.getElementById("statsSubmittedCount");const pendingEl=document.getElementById("statsPendingCount");if(totalEl)totalEl.textContent=total;if(submittedEl)submittedEl.textContent=submitted;if(pendingEl)pendingEl.textContent=pending}function withdrawFromDashboard(formName){showCustomConfirm(`Are you sure you want to withdraw from "${formName}"? This action cannot be undone.`,"Confirm Withdrawal",(confirmed)=>{if(!confirmed)return;const msgEl=document.getElementById("dashboardMessage");if(msgEl){msgEl.innerHTML='<div class="alert alert-info"><span>Withdrawing from '+formName+"...</span></div>"}google.script.run.withSuccessHandler(createSuccessHandler("withdrawFromDashboard",(r)=>{if(msgEl){msgEl.innerHTML=`<div class="alert ${r&&r.success?"alert-success":"alert-error"}"><span>${(r&&r.message)||"Unknown error"}</span></div>`}if(r&&r.success){loadDashboard();showAlert(r.message||"Withdrawal successful!","Withdrawal Complete",false)}setTimeout(()=>{if(msgEl)msgEl.innerHTML=""},3000)})).withFailureHandler(handleFailure).withdrawInterestWithToken(session.rollNo,session.sessionToken,formName)},"warning")}function loadFormConfig(){try{const title=document.getElementById("formTitle");if(title)title.textContent="Loading...";const desc=document.getElementById("formDescription");if(desc)desc.innerHTML="";const fileArea=document.getElementById("fileDownloadArea");if(fileArea)fileArea.innerHTML="";const dataEl=document.getElementById("studentData");if(dataEl)dataEl.innerHTML='<div class="text-center p-8 loading-overlay rounded-lg"><span class="loading loading-dots loading-lg text-primary"></span></div>';const customContainer=document.getElementById("customFieldsContainer");if(customContainer)customContainer.innerHTML="";const resultEl=document.getElementById("result");if(resultEl)resultEl.innerHTML="";show("detailsSection");hide("customSection");hide("customDivider");hide("actionSection");hide("closedBanner");const status=document.getElementById("openStatus");if(status)status.innerHTML="";const deadline=document.getElementById("deadlineText");if(deadline)deadline.textContent="";const countdown=document.getElementById("countdownText");if(countdown)countdown.textContent="";if(countdownTimer)clearInterval(countdownTimer)}catch(e){console.error("Error resetting form view:",e)}google.script.run.withSuccessHandler(createSuccessHandler("loadFormConfig",(cfg)=>{if(!cfg||cfg.error){showDashboard();showAlert("Error loading form: "+((cfg&&cfg.error)||"Server returned no data."),"Form Error");return}try{formConfig=cfg;fieldsConfig=cfg.fields||[];const title=document.getElementById("formTitle");if(title)title.textContent=cfg.formName;const desc=document.getElementById("formDescription");if(desc)desc.innerHTML=cfg.description?cfg.description.replace(/\n/g,"<br/>"):"";const fileArea=document.getElementById("fileDownloadArea");if(fileArea){fileArea.innerHTML=cfg.fileLink?`<a href="${cfg.fileLink.startsWith("http")?cfg.fileLink:"//"+cfg.fileLink}" target="_blank" rel="noopener noreferrer" class="btn btn-outline btn-enhanced no-default"><i data-lucide="download" class="w-4 h-4 mr-2"></i>Download Attachment</a>`:""}const openStatus=document.getElementById("openStatus");if(openStatus){if(cfg.isOpen){openStatus.innerHTML='<div class="badge badge-success">Open</div>';hide("closedBanner")}else{openStatus.innerHTML='<div class="badge badge-error">Closed</div>';show("closedBanner")}}const deadline=document.getElementById("deadlineText");if(deadline)deadline.textContent=fmtDateTime(cfg.deadlineMs);startCountdown(cfg.deadlineMs);loadCandidate(!cfg.isOpen)}catch(e){showAlert("Error displaying form configuration.","UI Error")}})).withFailureHandler((err)=>{handleFailure(err);showDashboard()}).getStudentFormConfigSecureWithToken(session.rollNo,session.sessionToken,currentFormName)}function loadCandidate(isFormClosed){google.script.run.withSuccessHandler(createSuccessHandler("loadCandidate/getStudentDataSecure",(sData)=>{if(!sData||sData.error){const dataEl=document.getElementById("studentData");if(dataEl)dataEl.innerHTML=`<div class="alert alert-error">${(sData&&sData.error)||"Could not load student data."}</div>`;show("detailsSection");hide("actionSection");return}let html='<table class="table table-sm"><tbody>';fieldsConfig.forEach((field)=>{if(field.source==="master"){const label=field.label;const key=field.key;const value=sData.hasOwnProperty(key)?sData[key]:"";html+=`<tr><th class="w-1/3 text-base-content/70">${label||"Error: No Label"}</th><td class="text-base-content">${value}</td></tr>`}});const dataEl=document.getElementById("studentData");if(dataEl)dataEl.innerHTML=html+"</tbody></table>";show("detailsSection");renderCustomFields();google.script.run.withSuccessHandler(createSuccessHandler("loadCandidate/getStudentResponseByRow",(eData)=>{let statusHtml="";let showSubmitUpdate=true;let showWithdraw=false;const submitBtn=document.getElementById("submitBtn");if(submitBtn)submitBtn.disabled=false;if(eData&&eData.exists){const interestedStatus=eData.data.Interested||"";if(interestedStatus==="Yes"){statusHtml="Status: <span class='badge badge-info'>Interested</span>";showWithdraw=true}fieldsConfig.filter((f)=>f.source==="custom").forEach((field,i)=>{const input=document.getElementById("custom_input_"+i);const value=eData.data[field.label]||"";if(input){if(field.type==="file"){input.dataset.currentValue=value;const statusEl=document.getElementById(`custom_input_${i}_status`);if(statusEl&&value){statusEl.innerHTML=`Current: <a href="${value}" target="_blank" class="link text-primary">View File</a> (Select new to replace)`}}else{input.value=value}}else if(field.type==="radio"){document.querySelectorAll(`input[name="custom_input_${i}"]`).forEach((radio)=>{radio.checked=radio.value===value})}})}else{if(submitBtn){submitBtn.innerHTML='<span class="hidden loading loading-spinner loading-sm"></span><i data-lucide="send" class="w-4 h-4 mr-2"></i>Submit Application'}}const statusEl=document.getElementById("currentStatus");if(statusEl)statusEl.innerHTML=statusHtml;if(isFormClosed){hide("actionSection")}else{let el=document.getElementById("submitBtn");if(el)el.classList.toggle("hidden",!showSubmitUpdate);el=document.getElementById("withdrawBtn");if(el)el.classList.toggle("hidden",!showWithdraw);show("actionSection")}})).withFailureHandler(handleFailure).getStudentResponseByRow(currentFormName,session.rowID)})).withFailureHandler(handleFailure).getStudentDataSecureWithToken(session.rollNo,session.sessionToken)}function renderCustomFields(){const container=document.getElementById("customFieldsContainer");if(!container)return;container.innerHTML="";const customFields=fieldsConfig.filter((f)=>f.source==="custom");if(customFields.length===0){hide("customSection");hide("customDivider");return}show("customSection");show("customDivider");let html="";customFields.forEach((field,i)=>{html+=`<div class="form-control w-full"><label class="label"><span class="label-text font-medium text-base-content">${field.label}</span></label>`;switch(field.type){case"textarea":html+=`<textarea id="custom_input_${i}" placeholder="Enter details here" class="textarea textarea-bordered input-enhanced w-full no-default"></textarea>`;break;case"dropdown":html+=`<select id="custom_input_${i}" class="select select-bordered input-enhanced w-full no-default"><option value="">Select an option</option>`;(field.options||"").split(",").forEach((opt)=>{const val=opt.trim();if(val)html+=`<option value="${val}">${val}</option>`});html+=`</select>`;break;case"radio":html+='<div class="flex flex-wrap gap-4">';(field.options||"").split(",").forEach((opt)=>{const val=opt.trim();if(val){html+=`<label class="label cursor-pointer gap-2"><span class="label-text">${val}</span><input type="radio" id="custom_input_${i}_${val.replace(/\W/g,"_")}" name="custom_input_${i}" value="${val}" class="radio radio-primary no-default" /></label>`}});html+="</div>";break;case"file":html+=`<input type="file" id="custom_input_${i}" class="file-input file-input-bordered input-enhanced w-full no-default" /><div class="label"><span class="label-text-alt text-base-content/60" id="custom_input_${i}_status"></span></div>`;break;default:html+=`<input type="text" id="custom_input_${i}" placeholder="Enter details here" class="input input-bordered input-enhanced w-full no-default" />`}html+=`</div>`});container.innerHTML=html;customFields.forEach((field,i)=>{if(field.type==="file"){const input=document.getElementById(`custom_input_${i}`);const statusEl=document.getElementById(`custom_input_${i}_status`);if(input&&statusEl){input.addEventListener("change",()=>{statusEl.textContent=input.files[0]?`Selected: ${input.files[0].name}`:"No file chosen"});const currentVal=input.dataset.currentValue;statusEl.innerHTML=currentVal?`Current: <a href="${currentVal}" target="_blank" class="link text-primary">View File</a> (Select new to replace)`:"No file uploaded"}}})}async function readFileAsBase64(file){return new Promise((resolve,reject)=>{const reader=new FileReader();reader.onload=()=>resolve({base64:reader.result,name:file.name,type:file.type});reader.onerror=(err)=>reject(err);reader.readAsDataURL(file)})}function submitForm(){if(!formConfig.isOpen){return showAlert("This form is not currently accepting responses.","Form Closed",false)}showSubmitConfirm((confirmed)=>{if(!confirmed)return;const formData={RollNo:session.rollNo};const resultEl=document.getElementById("result");if(!resultEl)return;const submitBtn=document.getElementById("submitBtn");const btnSpinner=submitBtn?submitBtn.querySelector(".loading"):null;if(!submitBtn||!btnSpinner)return;resultEl.className="text-info font-semibold";resultEl.innerHTML="Submitting...";submitBtn.disabled=true;btnSpinner.classList.remove("hidden");const filePromises=[];const customFields=fieldsConfig.filter((f)=>f.source==="custom");Promise.resolve().then(async()=>{for(const[index,field]of customFields.entries()){const fieldType=field.type;const fieldLabel=field.label;if(fieldType==="radio"){const radio=document.querySelector(`input[name="custom_input_${index}"]:checked`);formData[fieldLabel]=radio?radio.value:""}else{const input=document.getElementById(`custom_input_${index}`);if(input){if(fieldType==="file"){if(input.files[0]){resultEl.innerHTML="Uploading file...";const fileData=await readFileAsBase64(input.files[0]);formData[fieldLabel]=fileData}}else{formData[fieldLabel]=input.value}}}}await Promise.all(filePromises)}).then(()=>{resultEl.innerHTML="Saving response...";google.script.run.withSuccessHandler(createSuccessHandler("submitForm",(response)=>{const isSuccess=response&&response.success;resultEl.className=`font-semibold ${isSuccess?"text-success":"text-error"}`;resultEl.innerHTML=(response&&response.message)||"Unknown response";if(!isSuccess){submitBtn.disabled=false;btnSpinner.classList.add("hidden")}if(isSuccess){showAlert(response.message||"Form submitted successfully!","Submission Successful",false);showDashboard()}})).withFailureHandler((err)=>{handleFailure(err);submitBtn.disabled=false;btnSpinner.classList.add("hidden")}).submitOrUpdateResponseWithToken(session.rollNo,session.sessionToken,formData,currentFormName)}).catch(err=>{resultEl.className="text-error font-semibold";resultEl.innerHTML=`Error reading file/data: ${err.message}`;submitBtn.disabled=false;btnSpinner.classList.add("hidden")})})}function withdraw(){if(!formConfig.isOpen){return showAlert("This form is closed, you cannot withdraw.","Form Closed",false)}showCustomConfirm("Are you sure you want to withdraw your submission?","Confirm Withdrawal",(confirmed)=>{if(!confirmed)return;const resultEl=document.getElementById("result");if(!resultEl)return;resultEl.className="text-info font-semibold";resultEl.innerHTML="Withdrawing...";google.script.run.withSuccessHandler(createSuccessHandler("withdraw",(response)=>{const isSuccess=response&&response.success;resultEl.className=`font-semibold ${isSuccess?"text-success":"text-error"}`;resultEl.innerHTML=(response&&response.message)||"Unknown response";if(isSuccess){showAlert(response.message||"Withdrawal successful!","Withdrawal Complete",false);loadCandidate(false)}})).withFailureHandler(handleFailure).withdrawInterestWithToken(session.rollNo,session.sessionToken,currentFormName)},"warning")}function startCountdown(deadlineMs){const el=document.getElementById("countdownText");if(!el)return;if(countdownTimer)clearInterval(countdownTimer);if(!deadlineMs){el.textContent="";return}const update=()=>{const msLeft=deadlineMs-Date.now();if(msLeft<=0){el.textContent="";clearInterval(countdownTimer);if(currentFormName){const closedFormName=formConfig.formName||"The";showDashboard();showAlert(`${closedFormName} form has just closed.`,"Form Closed",false)}return}const sLeft=Math.floor(msLeft/1000);const d=Math.floor(sLeft/86400);const h=Math.floor((sLeft%86400)/3600);const m=Math.floor((sLeft%3600)/60);const s=sLeft%60;el.textContent=`Closes in: ${d}d ${String(h).padStart(2,"0")}:${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`};update();countdownTimer=setInterval(update,1000)}function showForgotPassword(event){if(event)event.preventDefault();const msgEl=document.getElementById("forgotPassMessage");if(msgEl)msgEl.innerHTML="";const rollEl=document.getElementById("forgotRollNo");if(rollEl)rollEl.value="";document.getElementById('forgotPassModal').showModal()}function sendPassword(){const btn=document.getElementById("sendPassBtn");const spinner=btn?btn.querySelector(".loading"):null;const rollNo=document.getElementById("forgotRollNo").value;const msgEl=document.getElementById("forgotPassMessage");if(!msgEl)return;if(!rollNo){msgEl.innerHTML='<div class="alert alert-warning"><span>Please enter your Roll Number.</span></div>';return}if(!btn||!spinner)return;btn.disabled=true;spinner.classList.remove("hidden");msgEl.innerHTML='<div class="alert alert-info"><span>Sending...</span></div>';google.script.run.withSuccessHandler(createSuccessHandler("sendPassword",(response)=>{btn.disabled=false;spinner.classList.add("hidden");msgEl.innerHTML=`<div class="alert ${response&&response.success?"alert-success":"alert-error"}"><span>${(response&&response.message)||"Unknown error"}</span></div>`;if(response&&response.success){setTimeout(()=>document.getElementById('forgotPassModal').close(),2000)}})).withFailureHandler((err)=>{handleFailure(err);btn.disabled=false;spinner.classList.add("hidden");msgEl.innerHTML=`<div class="alert alert-error"><span>${err.message}</span></div>`}).sendPasswordReminder(rollNo)}function loadProfile(){show("profileLoading");hide("profileContent");toggleProfileEdit(false);const msgEl=document.getElementById("profileMessage");if(msgEl)msgEl.innerHTML="";google.script.run.withSuccessHandler(createSuccessHandler("loadProfile",(response)=>{hide("profileLoading");if(!response||response.error){if(msgEl)msgEl.innerHTML=`<div class="alert alert-error"><span>Error loading profile: ${(response&&response.error)||"Received null"}</span></div>`;return}if(!response.success){if(msgEl)msgEl.innerHTML=`<div class="alert alert-error"><span>Error loading profile: ${response.message}</span></div>`;return}show("profileContent");const container=document.getElementById("profileContent");if(!container)return;const data=response.data;studentEditableFields=response.editableFields||[];container.innerHTML="";const sortedKeys=Object.keys(data).sort((a,b)=>{if(a==="RollNo")return-1;if(b==="RollNo")return 1;if(a==="Password")return-1;if(b==="Password")return 1;return a.localeCompare(b)});sortedKeys.forEach((key)=>{const isEditable=studentEditableFields.includes(key)&&key!=="RollNo"&&key!=="Password";container.innerHTML+=`<div class="form-control w-full"><label class="label"><span class="label-text font-semibold text-base-content">${key} ${isEditable?'<span class="text-xs text-primary">(Editable)</span>':""}</span></label><input type="text" id="profile_${key}" value="${data[key]||""}" class="input input-bordered input-enhanced w-full no-default" ${isEditable?"":"disabled"} /></div>`})})).withFailureHandler(handleFailure).getStudentProfileDataWithToken(session.rollNo,session.sessionToken)}function toggleProfileEdit(isEditing){hide("profileEditBtn");hide("profileCancelBtn");hide("profileSubmitBtn");const msgEl=document.getElementById("profileMessage");if(msgEl)msgEl.innerHTML="";document.querySelectorAll("#profileContent input").forEach((input)=>{const key=input.id.replace("profile_","");if(studentEditableFields.includes(key)&&key!=="RollNo"&&key!=="Password"){input.disabled=!isEditing}else{input.disabled=true}if(isEditing){input.defaultValue=input.value}else{input.value=input.defaultValue||input.value}});if(isEditing){show("profileCancelBtn");show("profileSubmitBtn")}else{show("profileEditBtn")}}function submitProfileChanges(){const btn=document.getElementById("profileSubmitBtn");const spinner=btn?btn.querySelector(".loading"):null;const msgEl=document.getElementById("profileMessage");if(!btn||!spinner||!msgEl)return;btn.disabled=true;spinner.classList.remove("hidden");msgEl.innerHTML='<div class="alert alert-info"><span>Saving changes...</span></div>';const changes={};document.querySelectorAll("#profileContent input:not(:disabled)").forEach((el)=>{const key=el.id.replace("profile_","");if(key!=="RollNo"){changes[key]=el.value}});google.script.run.withSuccessHandler(createSuccessHandler("submitProfileChanges",(response)=>{btn.disabled=false;spinner.classList.add("hidden");msgEl.innerHTML=`<div class="alert ${response&&response.success?"alert-success":"alert-error"}"><span>${(response&&response.message)||"Unknown error"}</span></div>`;if(response&&response.success){toggleProfileEdit(false);loadProfile();showAlert(response.message||"Profile updated successfully!","Profile Updated",false)}setTimeout(()=>(msgEl.innerHTML=""),4000)})).withFailureHandler((err)=>{btn.disabled=false;spinner.classList.add("hidden");msgEl.innerHTML=`<div class="alert alert-error"><span>Error: ${err.message}</span></div>`;handleFailure(err)}).updateStudentProfileDirectlyWithToken(session.rollNo,session.sessionToken,changes)}function submitPasswordChange(){const newPass=document.getElementById("newPassword").value;const confirmPass=document.getElementById("confirmNewPassword").value;const btn=document.getElementById("passwordSubmitBtn");const spinner=btn?btn.querySelector(".loading"):null;const msgEl=document.getElementById("passwordChangeMessage");if(!msgEl||!btn||!spinner){return}msgEl.innerHTML="";if(!newPass||!confirmPass){msgEl.innerHTML='<div class="alert alert-warning"><span>Please fill in both password fields.</span></div>';return}if(newPass.length<6){msgEl.innerHTML='<div class="alert alert-warning"><span>Password must be at least 6 characters long.</span></div>';return}if(newPass!==confirmPass){msgEl.innerHTML='<div class="alert alert-error"><span>Passwords do not match.</span></div>';return}btn.disabled=true;spinner.classList.remove("hidden");msgEl.innerHTML='<div class="alert alert-info"><span>Updating password...</span></div>';google.script.run.withSuccessHandler(createSuccessHandler("submitPasswordChange",(response)=>{btn.disabled=false;spinner.classList.add("hidden");if(response&&response.error){msgEl.innerHTML=`<div class="alert alert-error"><span>${response.error||"Could not change password."}</span></div>`}else{document.getElementById("newPassword").value="";document.getElementById("confirmNewPassword").value="";msgEl.innerHTML='<div class="alert alert-success"><span>Password updated successfully!</span></div>';showAlert("Your password has been updated successfully!","Password Changed",false);loadProfile();setTimeout(()=>{msgEl.innerHTML=""},4000)}})).withFailureHandler((err)=>{btn.disabled=false;spinner.classList.add("hidden");msgEl.innerHTML=`<div class="alert alert-error"><span>Server Error: ${err.message}</span></div>`;handleFailure(err)}).changeStudentPasswordWithToken(session.rollNo,session.sessionToken,newPass)}document.addEventListener("DOMContentLoaded",()=>{initTheme();document.getElementById("signInThemeToggle")?.addEventListener("click",()=>{const currentTheme=document.documentElement.getAttribute('data-theme');setTheme(currentTheme==='dark'?'pastel':'dark')});document.getElementById("mobileThemeToggle")?.addEventListener("click",()=>{const currentTheme=document.documentElement.getAttribute('data-theme');setTheme(currentTheme==='dark'?'pastel':'dark')});document.getElementById("desktopThemeToggle")?.addEventListener("click",()=>{const currentTheme=document.documentElement.getAttribute('data-theme');setTheme(currentTheme==='dark'?'pastel':'dark')});document.getElementById("signInBtn")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();signIn()});document.getElementById("forgotPassLink")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();showForgotPassword(e)});document.getElementById("sendPassBtn")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();sendPassword()});document.getElementById("rollNo")?.addEventListener("keypress",(e)=>{if(e.key==="Enter"){e.preventDefault();signIn()}});document.getElementById("password")?.addEventListener("keypress",(e)=>{if(e.key==="Enter"){e.preventDefault();signIn()}});document.getElementById("mobileNavDashboard")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();showDashboard()});document.getElementById("mobileNavProfile")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();showProfile()});document.getElementById("mobileSignOut")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();signOut()});document.getElementById("desktopNavDashboard")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();showDashboard()});document.getElementById("desktopNavProfile")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();showProfile()});document.getElementById("desktopSignOut")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();signOut()});document.getElementById("profileEditBtn")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();toggleProfileEdit(true)});document.getElementById("profileCancelBtn")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();toggleProfileEdit(false)});document.getElementById("profileSubmitBtn")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();submitProfileChanges()});document.getElementById("passwordSubmitBtn")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();submitPasswordChange()});const profileTab=document.getElementById("profileTab");const passwordTab=document.getElementById("passwordTab");profileTab?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();profileTab.classList.add("tab-active");passwordTab.classList.remove("tab-active");hide("passwordTabContent");show("profileTabContent")});passwordTab?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();passwordTab.classList.add("tab-active");profileTab.classList.remove("tab-active");hide("profileTabContent");show("passwordTabContent")});document.getElementById("backToDashboardBtn")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();showDashboard()});document.getElementById("withdrawBtn")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();withdraw()});document.getElementById("submitBtn")?.addEventListener("click",(e)=>{e.preventDefault();e.stopPropagation();submitForm()});document.getElementById("formsTbody")?.addEventListener("click",(e)=>{const button=e.target.closest("button[data-action]");if(!button)return;e.preventDefault();e.stopPropagation();const action=button.dataset.action;const formName=button.dataset.formName;if(!formName)return;if(action==="withdraw"){withdrawFromDashboard(formName)}else if(action==="view"){loadFormView(formName)}});window.addEventListener("popstate",(event)=>{if(event.state&&event.state.formName){currentFormName=event.state.formName}else{currentFormName=""}initPage()});initPage()});document.addEventListener("keydown",(e)=>{if(e.altKey&&e.key==="d"){e.preventDefault();showDashboard()}if(e.altKey&&e.key==="p"){e.preventDefault();showProfile()}if(e.altKey&&e.key==="t"){e.preventDefault();const currentTheme=document.documentElement.getAttribute('data-theme');setTheme(currentTheme==='dark'?'pastel':'dark')}if(e.key==="Escape"){document.querySelectorAll('dialog[open]').forEach(dialog=>{dialog.close()})}});window.addEventListener("resize",()=>{});window.addEventListener("error",(e)=>{console.error("Global error:",e.error);showAlert("An unexpected error occurred. Please refresh the page.","Error")});window.addEventListener("unhandledrejection",(e)=>{console.error("Unhandled promise rejection:",e.reason);showAlert("An unexpected error occurred. Please refresh the page.","Error")})</script><script>lucide.createIcons();document.documentElement.style.scrollBehavior='smooth';const modals=document.querySelectorAll('.modal');modals.forEach(modal=>{const focusableElements=modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');if(focusableElements.length>0){const firstElement=focusableElements[0];const lastElement=focusableElements[focusableElements.length-1];modal.addEventListener('keydown',(e)=>{if(e.key==='Tab'){if(e.shiftKey){if(document.activeElement===firstElement){e.preventDefault();lastElement.focus()}}else{if(document.activeElement===lastElement){e.preventDefault();firstElement.focus()}}}})}});window.addEventListener('load',()=>{document.body.classList.add('loaded')})</script><script>function togglePasswordVisibility(inputId){const passwordInput=document.getElementById(inputId);const toggleIcon=document.getElementById(inputId+'-toggle-icon');if(!passwordInput||!toggleIcon)return;if(passwordInput.type==='password'){passwordInput.type='text';toggleIcon.setAttribute('data-lucide','eye-off')}else{passwordInput.type='password';toggleIcon.setAttribute('data-lucide','eye')}lucide.createIcons();toggleIcon.style.transform='scale(0.8)';setTimeout(()=>{toggleIcon.style.transform='scale(1)'},150)}document.addEventListener('keydown',(e)=>{if(e.ctrlKey&&e.shiftKey&&e.key==='H'){const activeElement=document.activeElement;if(activeElement&&activeElement.type==='password'||activeElement.type==='text'){const inputId=activeElement.id;if(['password','newPassword','confirmNewPassword'].includes(inputId)){e.preventDefault();togglePasswordVisibility(inputId)}}}})</script></body></html>
